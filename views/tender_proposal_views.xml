<odoo>
	<data>
		<!-- Tender proposal tree view -->
		<record id="view_tender_proposal_tree" model="ir.ui.view">
			<field name="name">tender_cat.tender.proposal.tree</field>
			<field name="model">tender_cat.tender.proposal</field>
			<field name="arch" type="xml">
				<tree string="Tender proposal" class="tender_proposal_tree">
					<field name="doc_date" string="Date" optional="show"/>
					<field name="name" string="Name" />
					<field name="description" string="Description" />
					<field name="tender_id" string="Tender" optional="show"/>
					<field name="company_id" string="Company" optional="show"/>
					<field name="user_id" string="Manager" optional="show"/>
				</tree>
			</field>
		</record>
		<!-- Tender proposal form view -->
		<record id="view_tender_proposal_form" model="ir.ui.view">
			<field name="name">tender_cat.tender.proposal.form</field>
			<field name="model">tender_cat.tender.proposal</field>
			<field name="arch" type="xml">
				<form string="Tender proposal">
					<header>
                        <button name="action_download_zip" string="Download .zip" type="object" class="oe_read_only"/>
                    </header>
					<sheet>
						<div class="oe_title">
							<h3>
								<field name="name"/>
							</h3>
						</div>
						<field name="description" nolabel="1" string="Description" placeholder="Description"/>
						<group>
							<group>
								<field name="doc_date" string="Date"/>
								<field name="tender_id" string="Tender"/>
							</group>
							<group>
								<field name="company_id" string="Company"/>
								<field name="user_id" string="Manager"/>
							</group>
						</group>
						<notebook>
							<page string="Documents">
								<field name="doc_line_ids" widget="section_and_note_one2many" context="{'default_proposal_id': id}">
									<tree string="Documents" editable="bottom" class="tender_proposal_lines_tree">
										<control>
											<create name="add_doc_control" string="Add a document"/>
											<create name="add_section_control" string="Add a section"
													context="{'default_display_type': 'line_section'}"/>
											<create name="add_note_control" string="Add a note"
													context="{'default_display_type': 'line_note'}"/>
										</control>
										<field name="display_type" invisible="1"/>
										<field name="proposal_id" invisible="1"/>
										<field name="sequence" widget="handle"/>
										<field name="line_number" string="Nr" readonly="1"/>
										<field name="document_id"
											   attrs="{'required': [('display_type', '=', False)],}"
											   options="{'no_open': True}"
											   force_save="1"/>
										<field name="name" widget="section_and_note_text" attrs="{'required': [('display_type', '!=', False)],}"/>
									</tree>
								</field>
							</page>
						</notebook>
					</sheet>
					<div class="oe_chatter">
                    	<field name="message_follower_ids" widget="mail_followers" help="Follow this tender to automatically track the events associated to it" groups="base.group_user"/>
                    	<field name="message_ids" widget="mail_thread"/>
                	</div>
				</form>
			</field>
		</record>

		<!-- Tender proposal search view -->
		<record id="view_tender_proposal_search" model="ir.ui.view">
			<field name="name">tender_cat.tender.proposal.search</field>
			<field name="model">tender_cat.tender.proposal</field>
			<field name="arch" type="xml">
				<search string="Tender proposal">
					<field name="name" string="Name"/>
					<field name="description" string="Description"/>
					<field name="tender_id" string="Tender"/>
					<group expand="0" string="Group By">
						<filter string="Company" name="company" context="{'group_by': 'company_id'}"/>
						<filter string="Tender" name="tender" context="{'group_by': 'tender_id'}"/>
						<filter string="Manager" name="user" context="{'group_by': 'user_id'}"/>
						<filter string="Document date" name="doc_date" context="{'group_by': 'doc_date:month'}"/>
					</group>
				</search>
			</field>
		</record>
	</data>
</odoo>
